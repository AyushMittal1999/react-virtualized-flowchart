(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(t,e,i){t.exports=i(34)},32:function(t,e,i){},34:function(t,e,i){"use strict";i.r(e);var n=i(1),r=i(2),o=i(0),s=i.n(o),a=i(16),c=i.n(a),h=i(4),u=i(5),l=i(7),f=i(6),d=i(8),v=i(9),p=i(17),g=i.n(p);var m={ge:function(t,e,i,n,r){return"function"===typeof i?function(t,e,i,n,r){for(var o=i+1;e<=i;){var s=e+i>>>1;r(t[s],n)>=0?(o=s,i=s-1):e=s+1}return o}(t,void 0===n?0:0|n,void 0===r?t.length-1:0|r,e,i):function(t,e,i,n){for(var r=i+1;e<=i;){var o=e+i>>>1;t[o]>=n?(r=o,i=o-1):e=o+1}return r}(t,void 0===i?0:0|i,void 0===n?t.length-1:0|n,e)},gt:function(t,e,i,n,r){return"function"===typeof i?function(t,e,i,n,r){for(var o=i+1;e<=i;){var s=e+i>>>1;r(t[s],n)>0?(o=s,i=s-1):e=s+1}return o}(t,void 0===n?0:0|n,void 0===r?t.length-1:0|r,e,i):function(t,e,i,n){for(var r=i+1;e<=i;){var o=e+i>>>1;t[o]>n?(r=o,i=o-1):e=o+1}return r}(t,void 0===i?0:0|i,void 0===n?t.length-1:0|n,e)},lt:function(t,e,i,n,r){return"function"===typeof i?function(t,e,i,n,r){for(var o=e-1;e<=i;){var s=e+i>>>1;r(t[s],n)<0?(o=s,e=s+1):i=s-1}return o}(t,void 0===n?0:0|n,void 0===r?t.length-1:0|r,e,i):function(t,e,i,n){for(var r=e-1;e<=i;){var o=e+i>>>1;t[o]<n?(r=o,e=o+1):i=o-1}return r}(t,void 0===i?0:0|i,void 0===n?t.length-1:0|n,e)},le:function(t,e,i,n,r){return"function"===typeof i?function(t,e,i,n,r){for(var o=e-1;e<=i;){var s=e+i>>>1;r(t[s],n)<=0?(o=s,e=s+1):i=s-1}return o}(t,void 0===n?0:0|n,void 0===r?t.length-1:0|r,e,i):function(t,e,i,n){for(var r=e-1;e<=i;){var o=e+i>>>1;t[o]<=n?(r=o,e=o+1):i=o-1}return r}(t,void 0===i?0:0|i,void 0===n?t.length-1:0|n,e)},eq:function(t,e,i,n,r){return"function"===typeof i?function(t,e,i,n,r){for(;e<=i;){var o=e+i>>>1,s=r(t[o],n);if(0===s)return o;s<=0?e=o+1:i=o-1}return-1}(t,void 0===n?0:0|n,void 0===r?t.length-1:0|r,e,i):function(t,e,i,n){for(;e<=i;){var r=e+i>>>1,o=t[r];if(o===n)return r;o<=n?e=r+1:i=r-1}return-1}(t,void 0===i?0:0|i,void 0===n?t.length-1:0|n,e)}},y=0,b=1;function I(t,e,i,n,r){this.mid=t,this.left=e,this.right=i,this.leftPoints=n,this.rightPoints=r,this.count=(e?e.count:0)+(i?i.count:0)+n.length}var P=I.prototype;function E(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function w(t,e){var i=C(e);t.mid=i.mid,t.left=i.left,t.right=i.right,t.leftPoints=i.leftPoints,t.rightPoints=i.rightPoints,t.count=i.count}function T(t,e){var i=t.intervals([]);i.push(e),w(t,i)}function x(t,e){var i=t.intervals([]),n=i.indexOf(e);return n<0?y:(i.splice(n,1),w(t,i),b)}function M(t,e,i){for(var n=0;n<t.length&&t[n][0]<=e;++n){var r=i(t[n]);if(r)return r}}function k(t,e,i){for(var n=t.length-1;n>=0&&t[n][1]>=e;--n){var r=i(t[n]);if(r)return r}}function j(t,e){for(var i=0;i<t.length;++i){var n=e(t[i]);if(n)return n}}function O(t,e){return t-e}function V(t,e){var i=t[0]-e[0];return i||t[1]-e[1]}function R(t,e){var i=t[1]-e[1];return i||t[0]-e[0]}function C(t){if(0===t.length)return null;for(var e=[],i=0;i<t.length;++i)e.push(t[i][0],t[i][1]);e.sort(O);var n=e[e.length>>1],r=[],o=[],s=[];for(i=0;i<t.length;++i){var a=t[i];a[1]<n?r.push(a):n<a[0]?o.push(a):s.push(a)}var c=s,h=s.slice();return c.sort(V),h.sort(R),new I(n,C(r),C(o),c,h)}function A(t){this.root=t}P.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},P.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?T(this,t):this.left.insert(t):this.left=C([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?T(this,t):this.right.insert(t):this.right=C([t]);else{var i=m.ge(this.leftPoints,t,V),n=m.ge(this.rightPoints,t,R);this.leftPoints.splice(i,0,t),this.rightPoints.splice(n,0,t)}},P.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?x(this,t):2===(o=this.left.remove(t))?(this.left=null,this.count-=1,b):(o===b&&(this.count-=1),o):y;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?x(this,t):2===(o=this.right.remove(t))?(this.right=null,this.count-=1,b):(o===b&&(this.count-=1),o):y;if(1===this.count)return this.leftPoints[0]===t?2:y;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var i=this,n=this.left;n.right;)i=n,n=n.right;if(i===this)n.right=this.right;else{var r=this.left,o=this.right;i.count-=n.count,i.right=n.left,n.left=r,n.right=o}E(this,n),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?E(this,this.left):E(this,this.right);return b}for(r=m.ge(this.leftPoints,t,V);r<this.leftPoints.length&&this.leftPoints[r][0]===t[0];++r)if(this.leftPoints[r]===t){this.count-=1,this.leftPoints.splice(r,1);for(o=m.ge(this.rightPoints,t,R);o<this.rightPoints.length&&this.rightPoints[o][1]===t[1];++o)if(this.rightPoints[o]===t)return this.rightPoints.splice(o,1),b}return y},P.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(i=this.left.queryPoint(t,e))return i;return M(this.leftPoints,t,e)}if(t>this.mid){var i;if(this.right)if(i=this.right.queryPoint(t,e))return i;return k(this.rightPoints,t,e)}return j(this.leftPoints,e)},P.queryInterval=function(t,e,i){var n;if(t<this.mid&&this.left&&(n=this.left.queryInterval(t,e,i)))return n;if(e>this.mid&&this.right&&(n=this.right.queryInterval(t,e,i)))return n;return e<this.mid?M(this.leftPoints,e,i):t>this.mid?k(this.rightPoints,t,i):j(this.leftPoints,i)};var S=A.prototype;function q(t){return t&&0!==t.length?new A(C(t)):new A(null)}S.insert=function(t){this.root?this.root.insert(t):this.root=new I(t[0],null,null,[t],[t])},S.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),e!==y}return!1},S.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},S.queryInterval=function(t,e,i){if(t<=e&&this.root)return this.root.queryInterval(t,e,i)},Object.defineProperty(S,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(S,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var D=i(11);function N(t,e){var i=new Map(t.map(function(t){return[t.id,t]})),n=new Map(e.map(function(t){return[t.id,t]})),r=[],o=[];return i.forEach(function(t,e){n.has(e)&&i.get(e)===n.get(e)||o.push(t)}),n.forEach(function(t,e){i.has(e)&&i.get(e)===n.get(e)||r.push(t)}),{itemsAdded:r,itemsRemoved:o}}var X=function(t){function e(){var t,i;Object(h.a)(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(i=Object(l.a)(this,(t=Object(f.a)(e)).call.apply(t,[this].concat(r)))).removeConnectionsAndEndpoints=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(t){return i.plumbConnections[t.id]}).forEach(function(t){var e=t.endpoints;i.plumbInstance.deleteConnection(t),i.plumbInstance.deleteEndpoint(e[0]),i.plumbInstance.deleteEndpoint(e[1])})},i.addConnectionsAndEndpoints=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){var e=i.plumbInstance.addEndpoint(t.sourceId,{isSource:!0,anchor:"Bottom",paintStyle:{radius:1},connectorPaintStyle:{stroke:"blue",strokeWidth:0}}),n=i.plumbInstance.addEndpoint(t.targetId,{isTarget:!0,anchor:"Top",paintStyle:{fill:"blue",radius:1},connectorPaintStyle:{stroke:"blue",strokeWidth:0}});i.plumbConnections[t.id]=i.plumbInstance.connect({source:e,target:n,paintStyle:{stroke:"black"},connector:["Flowchart",{curviness:20}]})})},i}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this;D.jsPlumb.ready(function(){t.plumbInstance=D.jsPlumb.getInstance(t.props.containerEl),t.plumbConnections={},t.drawConnections(),t.makeVerticesDraggable(t.props.vertices)})}},{key:"componentDidUpdate",value:function(t){t.edges!==this.props.edges&&this.updateConnections(N(t.edges,this.props.edges)),t.vertices!==this.props.vertices&&this.updateVertices(N(t.vertices,this.props.vertices))}},{key:"makeVerticesDraggable",value:function(t){var e=this;t.map(function(t,i){e.plumbInstance.draggable(t.id,{stop:function(t){e.props.onAction({type:"ITEM_DRAGGED",payload:{vertexId:t.el.id,finalPos:t.finalPos}})}})})}},{key:"updateConnections",value:function(t){var e=t.itemsAdded,i=t.itemsRemoved;this.removeConnectionsAndEndpoints(i),this.addConnectionsAndEndpoints(e)}},{key:"updateVertices",value:function(t){var e=t.itemsAdded;t.itemsRemoved;this.makeVerticesDraggable(e)}},{key:"drawConnections",value:function(){this.addConnectionsAndEndpoints(this.props.edges)}},{key:"render",value:function(){return null}}]),e}(o.PureComponent);X.displayName="Edges",X.defaultProps={};var Y=X,G=Object(v.a)(function(t){return t.reduce(function(t,e){return t.rightMostVertex.left<e.left&&(t.rightMostVertex=e),t.bottomMostVertex.top<e.top&&(t.bottomMostVertex=e),t},{rightMostVertex:{left:-1},bottomMostVertex:{top:-1}})}),L=Object(v.a)(function(t,e,i,n){var o=new Map(t.map(function(t){return[t.id,t]})),s=new Map,a=new Map,c=new Map;return i.queryInterval(e.xMin,e.xMax,function(t){var e=Object(r.a)(t,3),i=(e[0],e[1],e[2]);s.set(i,o.get(i))}),n.queryInterval(e.yMin,e.yMax,function(t){var e=Object(r.a)(t,3),i=(e[0],e[1],e[2]);a.set(i,o.get(i))}),s.forEach(function(t,e){a.has(e)&&c.set(e,t)}),c});function B(t,e,i){var n=t.get(i);n?n.push(e):t.set(i,[e])}var J=Object(v.a)(function(t,e,i,n){return{xMin:t,xMax:t+i,yMin:e,yMax:e+n}});function F(t,e,i){t.remove(e[i]),delete e[i]}var U=function(t){function e(t){var i;return Object(h.a)(this,e),(i=Object(l.a)(this,Object(f.a)(e).call(this,t))).addToXIntervalTree=function(t){var e=[t.left,t.left+t.width,t.id];i.xIntervalTreeNodes[t.id]=e,i.xIntervalTree.insert(e)},i.addToYIntervalTree=function(t){var e=[t.top,t.top+t.height,t.id];i.yIntervalTreeNodes[t.id]=e,i.yIntervalTree.insert(e)},i.updateScroll=g()(function(t){i.setState({scroll:{left:t.scrollLeft,top:t.scrollTop}})},0),i.handleScroll=function(t){i.updateScroll(t.target)},i.state={scroll:{left:0,top:0},container:{height:0,width:0},version:0,isContainerElReady:!1},i.containerRef=s.a.createRef(),i.initIntervalTrees(),i.initVerticesToEdgesMap(t.vertices,t.edges),i}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this.containerRef.current.getBoundingClientRect(),e=t.height,i=t.width;this.setState({container:{height:e,width:i},isContainerElReady:!0})}},{key:"componentDidUpdate",value:function(t,e,i){t.vertices!==this.props.vertices&&(this.updateIntervalTrees(N(t.vertices,this.props.vertices)),this.setState(function(t){return{version:t.version+1}}))}},{key:"initIntervalTrees",value:function(){this.initXIntervalTree(this.props.vertices),this.initYIntervalTree(this.props.vertices)}},{key:"initXIntervalTree",value:function(t){this.xIntervalTree=q(),this.xIntervalTreeNodes={},t.forEach(this.addToXIntervalTree)}},{key:"initYIntervalTree",value:function(t){this.yIntervalTree=q(),this.yIntervalTreeNodes={},t.forEach(this.addToYIntervalTree)}},{key:"initVerticesToEdgesMap",value:function(t,e){this.verticesToEdgesMap=e.reduce(function(t,e){return B(t,e,e.sourceId),B(t,e,e.targetId),t},new Map)}},{key:"updateIntervalTrees",value:function(t){var e=this,i=t.itemsAdded;t.itemsRemoved.forEach(function(t){var i=t.id;F(e.xIntervalTree,e.xIntervalTreeNodes,i),F(e.yIntervalTree,e.yIntervalTreeNodes,i)}),i.forEach(function(t){e.addToXIntervalTree(t),e.addToYIntervalTree(t)})}},{key:"getVisibleVertices",value:function(){var t=this.state,e=t.scroll,i=t.container;return L(this.props.vertices,J(e.left,e.top,i.width,i.height),this.xIntervalTree,this.yIntervalTree)}},{key:"renderSentinel",value:function(){var t=G(this.props.vertices),e=t.rightMostVertex,i=t.bottomMostVertex,n=e.left+e.width+100,r=i.top+i.width+100;return s.a.createElement("div",{style:{height:1,width:1,position:"absolute",left:0,top:0,transform:"translate3d(".concat(n,"px, ").concat(r,"px, 0)")}})}},{key:"renderVertices",value:function(t){var e=this;return t.map(function(t){return s.a.createElement(s.a.Fragment,{key:t.id},e.props.renderVertex({vertex:t}))})}},{key:"renderEdges",value:function(t,e){return this.state.isContainerElReady?s.a.createElement(Y,{onAction:this.props.onAction,edges:Object(n.a)(t.values()),vertices:e,containerEl:this.containerRef.current}):null}},{key:"render",value:function(){var t=this.getVisibleVertices(),e=function(t,e,i){var r=new Map(i.map(function(t){return[t.id,t]}));return Object(n.a)(t.values()).reduce(function(i,n){return(e.get(n.id)||[]).forEach(function(e){i.edges.set(e.id,e),t.has(e.sourceId)||i.missedVertices.set(e.sourceId,r.get(e.sourceId)),t.has(e.targetId)||i.missedVertices.set(e.targetId,r.get(e.targetId))}),i},{edges:new Map,missedVertices:new Map})}(t,this.verticesToEdgesMap,this.props.vertices),i=e.edges,r=e.missedVertices,o=[].concat(Object(n.a)(t.values()),Object(n.a)(r.values()));return s.a.createElement("div",{ref:this.containerRef,className:"diagramContainer full-height",onScroll:this.handleScroll},this.renderVertices(o),this.renderEdges(i,o),this.renderSentinel())}}]),e}(s.a.PureComponent);U.defaultProps={edges:[]};var W=U,_=[0,2e3],z=[0,3e3],H=[100,300],K=[100,300];function Q(t,e){return Math.floor(Math.random()*(e-t))+t}Object(n.a)(Array(100)).map(function(t,e){return i=e,{left:Q(_[0],_[1]),top:Q(z[0],z[1]),width:Q(H[0],H[1]),height:Q(K[0],K[1]),label:i,id:i};var i});var Z=250,$=250,tt=25,et=(_[1]-_[0])/(Z+tt),it=(z[1]-z[0])/($+tt);!function(){for(var t=[],e=0;e<it;e++)for(var i=0;i<et;i++)t.push({left:i*(Z+tt),top:e*($+tt),width:Z,height:$,label:"".concat(i,"-").concat(e),id:"".concat(i,"-").concat(e)})}();var nt=i(3),rt=200,ot=200,st={initialVertices:[{left:300,top:100,width:rt,height:ot,label:"Root",id:"r"},{left:300-rt,top:500,width:rt,height:ot,label:"L1",id:"l1"},{left:300+rt,top:500,width:rt,height:ot,label:"R1",id:"r1"},{left:500-rt,top:1e3,width:rt,height:ot,label:"R1L2",id:"r1l2"},{left:500+rt,top:1e3,width:rt,height:ot,label:"R1R2",id:"r1r2"},{left:500+rt-rt,top:1500,width:rt,height:ot,label:"R1R2L3",id:"r1r2l3"},{left:500+rt+rt,top:1500,width:rt,height:ot,label:"R1R2R3",id:"r1r2r3"}].map(function(t){return Object(nt.a)({},t,{top:t.top+1e3})}),initialEdges:[{id:"r-l1"},{id:"r-r1"},{id:"r1-r1l2"},{id:"r1-r1r2"},{id:"r1r2-r1r2l3"},{id:"r1r2-r1r2r3"}].map(function(t){return Object(nt.a)({},t,{sourceId:t.id.split("-")[0],targetId:t.id.split("-")[1]})})};function at(t){return{vertices:t.initialVertices,edges:t.initialEdges}}function ct(t,e){switch(e.type){case"ITEM_DRAGGED":var i=t.vertices.map(function(t){return t.id===e.payload.vertexId?Object(nt.a)({},t,{left:e.payload.finalPos[0],top:e.payload.finalPos[1]}):t});return Object(nt.a)({},t,{vertices:i})}}function ht(t){var e=t.vertex;return s.a.createElement("div",{id:e.id,className:"vertex",style:{height:e.height,width:e.width,position:"absolute",left:e.left,top:e.top}},s.a.createElement("span",null,JSON.stringify(e)))}i(32);var ut=document.getElementById("root");c.a.render(s.a.createElement(function(){var t=Object(o.useReducer)(ct,st,at),e=Object(r.a)(t,2),i=e[0],n=e[1],a=Object(o.useCallback)(function(t){var e=t.vertex;return s.a.createElement(ht,{vertex:e})},[]);return s.a.createElement(W,{onAction:n,vertices:i.vertices,edges:i.edges,renderVertex:a})},null),ut)}},[[18,2,1]]]);
//# sourceMappingURL=main.36d9c5f3.chunk.js.map