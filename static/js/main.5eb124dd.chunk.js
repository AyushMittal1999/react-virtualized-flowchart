(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(t,e,n){t.exports=n(34)},32:function(t,e,n){},34:function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(2),o=n(0),s=n.n(o),a=n(16),c=n.n(a),l=n(4),u=n(5),h=n(7),d=n(6),f=n(8),v=n(9),p=n(17),g=n.n(p);var b={ge:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=n+1;e<=n;){var s=e+n>>>1;r(t[s],i)>=0?(o=s,n=s-1):e=s+1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=n+1;e<=n;){var o=e+n>>>1;t[o]>=i?(r=o,n=o-1):e=o+1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},gt:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=n+1;e<=n;){var s=e+n>>>1;r(t[s],i)>0?(o=s,n=s-1):e=s+1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=n+1;e<=n;){var o=e+n>>>1;t[o]>i?(r=o,n=o-1):e=o+1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},lt:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=e-1;e<=n;){var s=e+n>>>1;r(t[s],i)<0?(o=s,e=s+1):n=s-1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=e-1;e<=n;){var o=e+n>>>1;t[o]<i?(r=o,e=o+1):n=o-1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},le:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=e-1;e<=n;){var s=e+n>>>1;r(t[s],i)<=0?(o=s,e=s+1):n=s-1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=e-1;e<=n;){var o=e+n>>>1;t[o]<=i?(r=o,e=o+1):n=o-1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},eq:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(;e<=n;){var o=e+n>>>1,s=r(t[o],i);if(0===s)return o;s<=0?e=o+1:n=o-1}return-1}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(;e<=n;){var r=e+n>>>1,o=t[r];if(o===i)return r;o<=i?e=r+1:n=r-1}return-1}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)}},m=0,I=1;function y(t,e,n,i,r){this.mid=t,this.left=e,this.right=n,this.leftPoints=i,this.rightPoints=r,this.count=(e?e.count:0)+(n?n.count:0)+i.length}var E=y.prototype;function P(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function w(t,e){var n=R(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function j(t,e){var n=t.intervals([]);n.push(e),w(t,n)}function T(t,e){var n=t.intervals([]),i=n.indexOf(e);return i<0?m:(n.splice(i,1),w(t,n),I)}function O(t,e,n){for(var i=0;i<t.length&&t[i][0]<=e;++i){var r=n(t[i]);if(r)return r}}function x(t,e,n){for(var i=t.length-1;i>=0&&t[i][1]>=e;--i){var r=n(t[i]);if(r)return r}}function k(t,e){for(var n=0;n<t.length;++n){var i=e(t[n]);if(i)return i}}function M(t,e){return t-e}function C(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function V(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function R(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(M);var i=e[e.length>>1],r=[],o=[],s=[];for(n=0;n<t.length;++n){var a=t[n];a[1]<i?r.push(a):i<a[0]?o.push(a):s.push(a)}var c=s,l=s.slice();return c.sort(C),l.sort(V),new y(i,R(r),R(o),c,l)}function S(t){this.root=t}E.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},E.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?j(this,t):this.left.insert(t):this.left=R([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?j(this,t):this.right.insert(t):this.right=R([t]);else{var n=b.ge(this.leftPoints,t,C),i=b.ge(this.rightPoints,t,V);this.leftPoints.splice(n,0,t),this.rightPoints.splice(i,0,t)}},E.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?T(this,t):2===(o=this.left.remove(t))?(this.left=null,this.count-=1,I):(o===I&&(this.count-=1),o):m;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?T(this,t):2===(o=this.right.remove(t))?(this.right=null,this.count-=1,I):(o===I&&(this.count-=1),o):m;if(1===this.count)return this.leftPoints[0]===t?2:m;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,i=this.left;i.right;)n=i,i=i.right;if(n===this)i.right=this.right;else{var r=this.left,o=this.right;n.count-=i.count,n.right=i.left,i.left=r,i.right=o}P(this,i),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?P(this,this.left):P(this,this.right);return I}for(r=b.ge(this.leftPoints,t,C);r<this.leftPoints.length&&this.leftPoints[r][0]===t[0];++r)if(this.leftPoints[r]===t){this.count-=1,this.leftPoints.splice(r,1);for(o=b.ge(this.rightPoints,t,V);o<this.rightPoints.length&&this.rightPoints[o][1]===t[1];++o)if(this.rightPoints[o]===t)return this.rightPoints.splice(o,1),I}return m},E.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return O(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return x(this.rightPoints,t,e)}return k(this.leftPoints,e)},E.queryInterval=function(t,e,n){var i;if(t<this.mid&&this.left&&(i=this.left.queryInterval(t,e,n)))return i;if(e>this.mid&&this.right&&(i=this.right.queryInterval(t,e,n)))return i;return e<this.mid?O(this.leftPoints,e,n):t>this.mid?x(this.rightPoints,t,n):k(this.leftPoints,n)};var A=S.prototype;function q(t){return t&&0!==t.length?new S(R(t)):new S(null)}A.insert=function(t){this.root?this.root.insert(t):this.root=new y(t[0],null,null,[t],[t])},A.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),e!==m}return!1},A.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},A.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(A,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(A,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var N=n(11);function D(t,e){var n=new Map(t.map(function(t){return[t.id,t]})),i=new Map(e.map(function(t){return[t.id,t]})),r=[],o=[];return n.forEach(function(t,e){i.has(e)&&n.get(e)===i.get(e)||o.push(t)}),i.forEach(function(t,e){n.has(e)&&n.get(e)===i.get(e)||r.push(t)}),{itemsAdded:r,itemsRemoved:o}}var L=function(t){function e(){var t,n;Object(l.a)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(r)))).removeConnectionsAndEndpoints=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(t){return n.plumbConnections[t.id]}).forEach(function(t){var e=t.endpoints;n.plumbInstance.deleteConnection(t),n.plumbInstance.deleteEndpoint(e[0]),n.plumbInstance.deleteEndpoint(e[1])})},n.addConnectionsAndEndpoints=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){var e=n.plumbInstance.addEndpoint(t.sourceId,{isSource:!0,anchor:"Bottom",paintStyle:{radius:1},connectorPaintStyle:{stroke:"blue",strokeWidth:0}}),i=n.plumbInstance.addEndpoint(t.targetId,{isTarget:!0,anchor:"Top",paintStyle:{fill:"blue",radius:1},connectorPaintStyle:{stroke:"blue",strokeWidth:0}});n.plumbConnections[t.id]=n.plumbInstance.connect({source:e,target:i,paintStyle:{stroke:"black"},connector:["Flowchart",{curviness:0,cornerRadius:20}],overlays:[["Label",{label:t.name}]]})})},n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this;N.jsPlumb.ready(function(){t.plumbInstance=N.jsPlumb.getInstance(t.props.containerEl),t.plumbConnections={},t.drawConnections(),t.makeVerticesDraggable(t.props.vertices)})}},{key:"componentDidUpdate",value:function(t){t.edges!==this.props.edges&&this.updateConnections(D(t.edges,this.props.edges)),t.vertices!==this.props.vertices&&this.updateVertices(D(t.vertices,this.props.vertices))}},{key:"makeVerticesDraggable",value:function(t){var e=this;t.map(function(t,n){e.plumbInstance.draggable(t.id,{stop:function(t){e.props.onAction({type:"ITEM_DRAGGED",payload:{vertexId:t.el.id,finalPos:t.finalPos,index:n}})}})})}},{key:"updateConnections",value:function(t){var e=t.itemsAdded,n=t.itemsRemoved;this.removeConnectionsAndEndpoints(n),this.addConnectionsAndEndpoints(e)}},{key:"updateVertices",value:function(t){var e=t.itemsAdded;t.itemsRemoved;this.makeVerticesDraggable(e)}},{key:"drawConnections",value:function(){this.addConnectionsAndEndpoints(this.props.edges)}},{key:"render",value:function(){return null}}]),e}(o.PureComponent);L.displayName="Edges",L.defaultProps={};var X=L,Y=Object(v.a)(function(t){return t.reduce(function(t,e){return t.rightMostVertex.left<e.left&&(t.rightMostVertex=e),t.bottomMostVertex.top<e.top&&(t.bottomMostVertex=e),t},{rightMostVertex:{left:-1},bottomMostVertex:{top:-1}})}),B=Object(v.a)(function(t,e,n,i,o){var s=new Map(t.map(function(t){return[t.id,t]})),a=new Map,c=new Map,l=new Map;return n.queryInterval(e.xMin,e.xMax,function(t){var e=Object(r.a)(t,3),n=(e[0],e[1],e[2]);a.set(n,s.get(n))}),i.queryInterval(e.yMin,e.yMax,function(t){var e=Object(r.a)(t,3),n=(e[0],e[1],e[2]);c.set(n,s.get(n))}),a.forEach(function(t,e){c.has(e)&&l.set(e,t)}),l});function F(t,e,n){var i=t.get(n);i?i.push(e):t.set(n,[e])}var G=Object(v.a)(function(t,e,n,i){return{xMin:t,xMax:t+n,yMin:e,yMax:e+i}});function J(t,e,n){t.remove(e[n]),delete e[n]}var U=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(h.a)(this,Object(d.a)(e).call(this,t))).addToXIntervalTree=function(t){var e=[t.left,t.left+t.width,t.id];n.xIntervalTreeNodes[t.id]=e,n.xIntervalTree.insert(e)},n.addToYIntervalTree=function(t){var e=[t.top,t.top+t.height,t.id];n.yIntervalTreeNodes[t.id]=e,n.yIntervalTree.insert(e)},n.updateScroll=g()(function(t){n.setState({scroll:{left:t.scrollLeft,top:t.scrollTop}})},0),n.handleScroll=function(t){n.updateScroll(t.target)},n.state={scroll:{left:0,top:0},container:{height:0,width:0},version:0,isContainerElReady:!1},n.vertices=t.vertices,n.containerRef=s.a.createRef(),n.initIntervalTrees(),n.initVerticesToEdgesMap(t.vertices,t.edges),n}return Object(f.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this.containerRef.current.getBoundingClientRect(),e=t.height,n=t.width;this.setState({container:{height:e,width:n},isContainerElReady:!0})}},{key:"componentDidUpdate",value:function(t,e,n){t.vertices!==this.props.vertices&&(this.vertices=this.props.vertices,this.updateIntervalTrees(D(t.vertices,this.props.vertices)),this.setState(function(t){return{version:t.version+1}})),t.edges!==this.props.edges&&(this.updateEdges(D(t.edges,this.props.edges)),this.setState(function(t){return{version:t.version+1}}))}},{key:"initIntervalTrees",value:function(){this.initXIntervalTree(this.props.vertices),this.initYIntervalTree(this.props.vertices)}},{key:"initXIntervalTree",value:function(t){this.xIntervalTree=q(),this.xIntervalTreeNodes={},t.forEach(this.addToXIntervalTree)}},{key:"initYIntervalTree",value:function(t){this.yIntervalTree=q(),this.yIntervalTreeNodes={},t.forEach(this.addToYIntervalTree)}},{key:"initVerticesToEdgesMap",value:function(t,e){this.verticesToEdgesMap=e.reduce(function(t,e){return F(t,e,e.sourceId),F(t,e,e.targetId),t},new Map)}},{key:"updateIntervalTrees",value:function(t){var e=this,n=t.itemsAdded;t.itemsRemoved.forEach(function(t){var n=t.id;J(e.xIntervalTree,e.xIntervalTreeNodes,n),J(e.yIntervalTree,e.yIntervalTreeNodes,n)}),n.forEach(function(t){e.addToXIntervalTree(t),e.addToYIntervalTree(t)})}},{key:"updateEdges",value:function(t){var e=this,n=t.itemsAdded;t.itemsRemoved.forEach(function(t){e.verticesToEdgesMap.delete(t.sourceId),e.verticesToEdgesMap.delete(t.targetId)}),n.forEach(function(t){F(e.verticesToEdgesMap,t,t.sourceId),F(e.verticesToEdgesMap,t,t.targetId)})}},{key:"getVisibleVertices",value:function(){var t=this.state,e=t.scroll,n=t.container,i=t.version;return B(this.vertices,G(e.left,e.top,n.width,n.height),this.xIntervalTree,this.yIntervalTree,i)}},{key:"renderSentinel",value:function(){var t=Y(this.vertices),e=t.rightMostVertex,n=t.bottomMostVertex,i=e.left+e.width+100,r=n.top+n.width+100;return s.a.createElement("div",{style:{height:1,width:1,position:"absolute",left:0,top:0,transform:"translate3d(".concat(i,"px, ").concat(r,"px, 0)")}})}},{key:"renderVertices",value:function(t){var e=this;return t.map(function(t,n){return s.a.createElement(s.a.Fragment,{key:t.id},e.props.renderVertex({vertex:t,index:n}))})}},{key:"renderEdges",value:function(t,e){return this.state.isContainerElReady?s.a.createElement(X,{onAction:this.props.onAction,edges:Object(i.a)(t.values()),vertices:e,containerEl:this.containerRef.current}):null}},{key:"render",value:function(){var t=this.getVisibleVertices(),e=function(t,e,n){var r=new Map(n.map(function(t){return[t.id,t]}));return Object(i.a)(t.values()).reduce(function(n,i){return(e.get(i.id)||[]).forEach(function(e){n.edges.set(e.id,e),t.has(e.sourceId)||n.missedVertices.set(e.sourceId,r.get(e.sourceId)),t.has(e.targetId)||n.missedVertices.set(e.targetId,r.get(e.targetId))}),n},{edges:new Map,missedVertices:new Map})}(t,this.verticesToEdgesMap,this.vertices),n=e.edges,r=e.missedVertices,o=[].concat(Object(i.a)(t.values()),Object(i.a)(r.values()));return s.a.createElement("div",{ref:this.containerRef,className:"diagramContainer full-height",onScroll:this.handleScroll},this.renderVertices(o),this.renderEdges(n,o),this.renderSentinel())}}]),e}(s.a.PureComponent);U.defaultProps={edges:[]};var W=U,_=[{id:"1",label:1,height:30,width:30,top:0,left:100},{id:"2",label:2,height:30,width:30,top:100,left:0},{id:"3",label:3,height:30,width:30,top:100,left:200}],z=[{id:"1-2",sourceId:"1",targetId:"2"},{id:"1-3",sourceId:"1",targetId:"3"}],H=[{id:"4",label:4,top:350,left:400,height:30,width:30},{id:"5",label:5,top:450,left:300,height:30,width:30},{id:"6",label:6,top:450,left:500,height:30,width:30}],K=[{id:"4-5",sourceId:"4",targetId:"5"},{id:"4-6",sourceId:"4",targetId:"6"}],Q=n(3),Z=200,$=200;[{left:300,top:100,width:Z,height:$,label:"Root",id:"r"},{left:300-Z,top:500,width:Z,height:$,label:"L1",id:"l1"},{left:300+Z,top:500,width:Z,height:$,label:"R1",id:"r1"},{left:500-Z,top:1e3,width:Z,height:$,label:"R1L2",id:"r1l2"},{left:500+Z,top:1e3,width:Z,height:$,label:"R1R2",id:"r1r2"},{left:500+Z-Z,top:1500,width:Z,height:$,label:"R1R2L3",id:"r1r2l3"},{left:500+Z+Z,top:1500,width:Z,height:$,label:"R1R2R3",id:"r1r2r3"}].map(function(t){return Object(Q.a)({},t,{top:t.top+1e3})}),[{id:"r-l1"},{id:"r-r1"},{id:"r1-r1l2"},{id:"r1-r1r2"},{id:"r1r2-r1r2l3"},{id:"r1r2-r1r2r3"}].map(function(t){return Object(Q.a)({},t,{sourceId:t.id.split("-")[0],targetId:t.id.split("-")[1]})});n(32);function tt(t){var e=t.vertex;return s.a.createElement("div",{id:e.id,className:"vertex",style:{height:e.height,width:e.width,position:"absolute",left:e.left,top:e.top}},s.a.createElement("span",null,e.label))}var et=document.getElementById("root");c.a.render(s.a.createElement(function(){var t=Object(o.useState)(_),e=Object(r.a)(t,2),n=e[0],a=e[1],c=Object(o.useState)(Object(i.a)(z)),l=Object(r.a)(c,2),u=l[0],h=l[1],d=Object(o.useCallback)(function(){a([].concat(Object(i.a)(n),Object(i.a)(H))),h([].concat(Object(i.a)(u),[{id:"3-4",sourceId:"3",targetId:"4"}],Object(i.a)(K)))},[n,u]),f=Object(o.useCallback)(function(){h(u.filter(function(t){return"3-4"!==t.id}))},[u]),v=Object(o.useCallback)(function(){h([].concat(Object(i.a)(u),[{id:"3-4",sourceId:"3",targetId:"4"}]))},[u]),p=Object(o.useCallback)(function(){a(_),h(z)}),g=Object(o.useMemo)(function(){return{ss1:{label:"Add subtree to 3",next:"ss2",handler:d},ss2:{label:"remove subtree",next:"ss1",handler:p}}},[d,p]),b=Object(o.useMemo)(function(){return{sc1:{label:"remove 3-4 connection",next:"sc2",handler:f},sc2:{label:"connect 3-4",next:"sc1",handler:v}}},[f,v]),m=Object(o.useState)("ss1"),I=Object(r.a)(m,2),y=I[0],E=I[1],P=Object(o.useState)("sc1"),w=Object(r.a)(P,2),j=w[0],T=w[1],O=Object(o.useCallback)(function(t){var e=t.vertex;return s.a.createElement(tt,{vertex:e})},[]);return s.a.createElement("div",{className:"App"},s.a.createElement(W,{vertices:n,edges:u,renderVertex:O}),s.a.createElement("button",{onClick:function(){g[y].handler(),E(g[y].next)}},g[y].label),s.a.createElement("button",{onClick:function(){b[j].handler(),T(b[j].next)}},b[j].label))},null),et)}},[[18,2,1]]]);
//# sourceMappingURL=main.5eb124dd.chunk.js.map