(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(t,e,n){t.exports=n(34)},33:function(t,e,n){},34:function(t,e,n){"use strict";n.r(e);var i=n(3),r=n(1),o=n(0),s=n.n(o),a=n(17),c=n.n(a),u=n(6),l=n(7),h=n(9),d=n(8),f=n(10),v=n(5),p=n(18),g=n.n(p),m=n(4),y=n.n(m);var E={ge:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=n+1;e<=n;){var s=e+n>>>1;r(t[s],i)>=0?(o=s,n=s-1):e=s+1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=n+1;e<=n;){var o=e+n>>>1;t[o]>=i?(r=o,n=o-1):e=o+1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},gt:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=n+1;e<=n;){var s=e+n>>>1;r(t[s],i)>0?(o=s,n=s-1):e=s+1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=n+1;e<=n;){var o=e+n>>>1;t[o]>i?(r=o,n=o-1):e=o+1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},lt:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=e-1;e<=n;){var s=e+n>>>1;r(t[s],i)<0?(o=s,e=s+1):n=s-1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=e-1;e<=n;){var o=e+n>>>1;t[o]<i?(r=o,e=o+1):n=o-1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},le:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=e-1;e<=n;){var s=e+n>>>1;r(t[s],i)<=0?(o=s,e=s+1):n=s-1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=e-1;e<=n;){var o=e+n>>>1;t[o]<=i?(r=o,e=o+1):n=o-1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},eq:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(;e<=n;){var o=e+n>>>1,s=r(t[o],i);if(0===s)return o;s<=0?e=o+1:n=o-1}return-1}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(;e<=n;){var r=e+n>>>1,o=t[r];if(o===i)return r;o<=i?e=r+1:n=r-1}return-1}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)}},b=0,I=1;function T(t,e,n,i,r){this.mid=t,this.left=e,this.right=n,this.leftPoints=i,this.rightPoints=r,this.count=(e?e.count:0)+(n?n.count:0)+i.length}var x=T.prototype;function P(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function M(t,e){var n=A(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function O(t,e){var n=t.intervals([]);n.push(e),M(t,n)}function k(t,e){var n=t.intervals([]),i=n.indexOf(e);return i<0?b:(n.splice(i,1),M(t,n),I)}function w(t,e,n){for(var i=0;i<t.length&&t[i][0]<=e;++i){var r=n(t[i]);if(r)return r}}function V(t,e,n){for(var i=t.length-1;i>=0&&t[i][1]>=e;--i){var r=n(t[i]);if(r)return r}}function j(t,e){for(var n=0;n<t.length;++n){var i=e(t[n]);if(i)return i}}function S(t,e){return t-e}function R(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function C(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function A(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(S);var i=e[e.length>>1],r=[],o=[],s=[];for(n=0;n<t.length;++n){var a=t[n];a[1]<i?r.push(a):i<a[0]?o.push(a):s.push(a)}var c=s,u=s.slice();return c.sort(R),u.sort(C),new T(i,A(r),A(o),c,u)}function q(t){this.root=t}x.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},x.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?O(this,t):this.left.insert(t):this.left=A([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?O(this,t):this.right.insert(t):this.right=A([t]);else{var n=E.ge(this.leftPoints,t,R),i=E.ge(this.rightPoints,t,C);this.leftPoints.splice(n,0,t),this.rightPoints.splice(i,0,t)}},x.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?k(this,t):2===(o=this.left.remove(t))?(this.left=null,this.count-=1,I):(o===I&&(this.count-=1),o):b;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?k(this,t):2===(o=this.right.remove(t))?(this.right=null,this.count-=1,I):(o===I&&(this.count-=1),o):b;if(1===this.count)return this.leftPoints[0]===t?2:b;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,i=this.left;i.right;)n=i,i=i.right;if(n===this)i.right=this.right;else{var r=this.left,o=this.right;n.count-=i.count,n.right=i.left,i.left=r,i.right=o}P(this,i),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?P(this,this.left):P(this,this.right);return I}for(r=E.ge(this.leftPoints,t,R);r<this.leftPoints.length&&this.leftPoints[r][0]===t[0];++r)if(this.leftPoints[r]===t){this.count-=1,this.leftPoints.splice(r,1);for(o=E.ge(this.rightPoints,t,C);o<this.rightPoints.length&&this.rightPoints[o][1]===t[1];++o)if(this.rightPoints[o]===t)return this.rightPoints.splice(o,1),I}return b},x.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return w(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return V(this.rightPoints,t,e)}return j(this.leftPoints,e)},x.queryInterval=function(t,e,n){var i;if(t<this.mid&&this.left&&(i=this.left.queryInterval(t,e,n)))return i;if(e>this.mid&&this.right&&(i=this.right.queryInterval(t,e,n)))return i;return e<this.mid?w(this.leftPoints,e,n):t>this.mid?V(this.rightPoints,t,n):j(this.leftPoints,n)};var N=q.prototype;function D(t){return t&&0!==t.length?new q(A(t)):new q(null)}N.insert=function(t){this.root?this.root.insert(t):this.root=new T(t[0],null,null,[t],[t])},N.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),e!==b}return!1},N.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},N.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(N,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(N,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var B=n(2),X=n(12);function Y(t,e){var n=new Map(t.map(function(t){return[t.id,t]})),i=new Map(e.map(function(t){return[t.id,t]})),r=[],o=[];return n.forEach(function(t,e){i.has(e)&&n.get(e)===i.get(e)||o.push(t)}),i.forEach(function(t,e){n.has(e)&&n.get(e)===i.get(e)||r.push(t)}),{itemsAdded:r,itemsRemoved:o}}var F=function(t){function e(){var t,n;Object(u.a)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(r)))).handleStop=function(t){n.props.onAction({type:"ITEM_DRAGGED",payload:{vertexEl:t.el,finalPos:t.finalPos}})},n.removeConnectionsAndEndpoints=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(t){return n.plumbConnections[t.id]}).forEach(function(t){var e=t.endpoints;n.plumbInstance.deleteConnection(t),n.plumbInstance.deleteEndpoint(e[0]),n.plumbInstance.deleteEndpoint(e[1])})},n.addConnectionsAndEndpoints=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){var e=n.plumbInstance.addEndpoint(t.sourceId,Object(B.a)({},t.sourceEndpointStyles||n.props.sourceEndpointStyles,t.sourceEndpointOptions||n.props.sourceEndpointOptions,{isSource:!0})),i=n.plumbInstance.addEndpoint(t.targetId,Object(B.a)({},t.targetEndpointStyles||n.props.targetEndpointStyles,t.targetEndpointOptions||n.props.targetEndpointOptions,{isTarget:!0}));n.plumbConnections[t.id]=n.plumbInstance.connect(Object(B.a)({},t.styles||n.props.edgeStyles,t.options||n.props.edgeOptions,{source:e,target:i,overlays:t.overlays}))})},n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this;X.jsPlumb.ready(function(){t.plumbInstance=X.jsPlumb.getInstance(t.props.containerEl),t.plumbConnections={},t.drawConnections(),t.makeVerticesDraggable(t.props.vertices)})}},{key:"componentDidUpdate",value:function(t){t.edges!==this.props.edges&&this.updateConnections(Y(t.edges,this.props.edges)),t.vertices!==this.props.vertices&&this.updateVertices(Y(t.vertices,this.props.vertices))}},{key:"makeVerticesDraggable",value:function(t){var e=this;t.map(function(t){e.plumbInstance.draggable(t.id,Object(B.a)({},e.props.draggablePlumbOptions,{stop:e.handleStop}))})}},{key:"updateConnections",value:function(t){var e=t.itemsAdded,n=t.itemsRemoved;this.removeConnectionsAndEndpoints(n),this.addConnectionsAndEndpoints(e)}},{key:"updateVertices",value:function(t){var e=t.itemsAdded;t.itemsRemoved;this.makeVerticesDraggable(e)}},{key:"drawConnections",value:function(){this.addConnectionsAndEndpoints(this.props.edges)}},{key:"render",value:function(){return null}}]),e}(o.PureComponent);F.displayName="Edges",F.defaultProps={sourceEndpointStyles:{paintStyle:{radius:1},connectorPaintStyle:{stroke:"blue",strokeWidth:0}},sourceEndpointOptions:{anchor:"Bottom"},targetEndpointStyles:{paintStyle:{fill:"blue",radius:1},connectorPaintStyle:{stroke:"blue",strokeWidth:0}},targetEndpointOptions:{anchor:"Top"},edgeStyles:{paintStyle:{stroke:"black"},connector:["Flowchart",{curviness:0,cornerRadius:20}]}};var G=F;function L(t){return(t.left||0)+(t.width||0)}function J(t){return(t.top||0)+(t.height||0)}var U=Object(v.a)(function(t){return t.reduce(function(t,e){return L(t.rightMostVertex)<L(e)&&(t.rightMostVertex=e),J(t.bottomMostVertex)<J(e)&&(t.bottomMostVertex=e),t},{rightMostVertex:{left:-1,width:0},bottomMostVertex:{top:-1,height:0}})});var W=Object(v.a)(function(t,e,n){var i=new Map;return e.forEach(function(e){i.set(e.sourceId,t.get(e.sourceId)),i.set(e.targetId,t.get(e.targetId))}),i}),_=Object(v.a)(function(t,e,n,i){var o=new Map,s=new Map,a=new Map;return e.queryInterval(t.xMin,t.xMax,function(t){var e=Object(r.a)(t,3),n=(e[0],e[1],e[2]);o.set(n.id,n)}),n.queryInterval(t.yMin,t.yMax,function(t){var e=Object(r.a)(t,3),n=(e[0],e[1],e[2]);s.set(n.id,n)}),o.forEach(function(t,e){s.has(e)&&a.set(e,t)}),a});function z(t,e,n){var i=t.get(n);i?i.push(e):t.set(n,[e])}function H(t,e,n){var i=t.get(n);i&&(i=i.filter(function(t){return t.id!==e})),i&&i.length?t.set(n,i):t.delete(n)}var K=Object(v.a)(function(t,e,n,i){return{xMin:t,xMax:t+n,yMin:e,yMax:e+i}});function Q(t,e,n){e[n]&&(t.remove(e[n]),delete e[n])}var Z=function(t){function e(t){var n;Object(u.a)(this,e),(n=Object(h.a)(this,Object(d.a)(e).call(this,t))).addToXIntervalTree=function(t,e){var i=t.id;if(!n.xIntervalTreeNodes[i]){var r=e.get(t.sourceId);y()(r,"sourceVertex missing for the edgeId - ".concat(i));var o=e.get(t.targetId);y()(o,"targetVertex missing for the edgeId - ".concat(i));var s=function(t,e,n){return[Math.min(e.left,n.left)||0,Math.max((e.left||0)+(e.width||0),(n.left||0)+(n.width||0)),t]}(t,r.vertex,o.vertex);n.xIntervalTreeNodes[i]=s,n.xIntervalTree.insert(s)}},n.addToYIntervalTree=function(t,e){var i=t.id;if(!n.yIntervalTreeNodes[i]){var r=e.get(t.sourceId);y()(r,"sourceVertex missing for the edgeId - ".concat(i));var o=e.get(t.targetId);y()(o,"targetVertex missing for the edgeId - ".concat(i));var s=function(t,e,n){return[Math.min(e.top,n.top)||0,Math.max((e.top||0)+(e.height||0),(n.top||0)+(n.height||0)),t]}(t,r.vertex,o.vertex);n.yIntervalTreeNodes[i]=s,n.yIntervalTree.insert(s)}},n.addEdgeToVerticesToEdgesMap=function(t){z(n.verticesToEdgesMap,t,t.sourceId),z(n.verticesToEdgesMap,t,t.targetId)},n.removeEdgeFromVerticesToEdgesMap=function(t){H(n.verticesToEdgesMap,t.id,t.sourceId),H(n.verticesToEdgesMap,t.id,t.targetId)},n.updateScroll=g()(function(t){n.setState({scroll:{left:t.scrollLeft,top:t.scrollTop}})},0),n.handleScroll=function(t){t.target===t.currentTarget&&n.updateScroll(t.currentTarget)},n.state={scroll:{left:0,top:0},container:{height:0,width:0},version:0,isContainerElReady:!1},n.containerRef=s.a.createRef();var i=n.setVertices(t.vertices).verticesMap;return n.initVerticesToEdgesMap(t.edges),n.initIntervalTrees(t.edges,i),n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this.containerRef.current.getBoundingClientRect(),e=t.height,n=t.width;this.setState({container:{height:e,width:n},isContainerElReady:!0})}},{key:"componentDidUpdate",value:function(t,e,n){var i=!1,r=t.vertices!==this.props.vertices,o=this.verticesMap,s=this.verticesToEdgesMap;r&&(o=this.setVertices(this.props.vertices).verticesMap),t.edges!==this.props.edges&&(s=this.updateEdges(Y(t.edges,this.props.edges),o).verticesToEdgesMap,i=!0),r&&(this.updateIntervalTrees(Y(t.vertices,this.props.vertices),s),i=!0),i&&this.setState(function(t){return{version:t.version+1}})}},{key:"setVertices",value:function(t){return this.vertices=t,this.verticesMap=function(t){return new Map(t.map(function(t,e){return[t.id,{vertex:t,index:e}]}))}(t),{vertices:this.vertices,verticesMap:this.verticesMap}}},{key:"initIntervalTrees",value:function(t,e){this.initXIntervalTree(t,e),this.initYIntervalTree(t,e)}},{key:"initVerticesToEdgesMap",value:function(t){this.verticesToEdgesMap=t.reduce(function(t,e){return z(t,e,e.sourceId),z(t,e,e.targetId),t},new Map)}},{key:"initXIntervalTree",value:function(t,e){var n=this;this.xIntervalTree=D(),this.xIntervalTreeNodes={},t.forEach(function(t){return n.addToXIntervalTree(t,e)})}},{key:"initYIntervalTree",value:function(t,e){var n=this;this.yIntervalTree=D(),this.yIntervalTreeNodes={},t.forEach(function(t){return n.addToYIntervalTree(t,e)})}},{key:"updateIntervalTrees",value:function(t,e){var n=this,i=t.itemsAdded;t.itemsRemoved.forEach(function(t){var i=t.id;(e.get(i)||[]).forEach(function(t){Q(n.xIntervalTree,n.xIntervalTreeNodes,t.id),Q(n.yIntervalTree,n.yIntervalTreeNodes,t.id)})}),i.forEach(function(t){var i=e.get(t.id),r=n.verticesMap;i.forEach(function(t){n.addToXIntervalTree(t,r),n.addToYIntervalTree(t,r)})})}},{key:"updateEdges",value:function(t,e){var n=this,i=t.itemsAdded;return t.itemsRemoved.forEach(function(t){var e=t.id;n.removeEdgeFromVerticesToEdgesMap(t),Q(n.xIntervalTree,n.xIntervalTreeNodes,e),Q(n.yIntervalTree,n.yIntervalTreeNodes,e)}),i.forEach(function(t){n.addEdgeToVerticesToEdgesMap(t),n.addToXIntervalTree(t,e),n.addToYIntervalTree(t,e)}),{verticesToEdgesMap:this.verticesToEdgesMap}}},{key:"getVisibleEdges",value:function(){var t=this.state,e=t.scroll,n=t.container,i=t.version;return _(K(e.left,e.top,n.width,n.height),this.xIntervalTree,this.yIntervalTree,i)}},{key:"getVisibleVertices",value:function(){var t=this.state.version;return W(this.verticesMap,this.getVisibleEdges(),t)}},{key:"getExtremeXAndY",value:function(){var t=U(this.vertices),e=t.rightMostVertex,n=t.bottomMostVertex;return[L(e)+100,J(n)+100]}},{key:"renderSentinel",value:function(t,e){return s.a.createElement("div",{style:{height:1,width:1,position:"absolute",left:0,top:0,transform:"translate3d(".concat(t,"px, ").concat(e,"px, 0)")}})}},{key:"renderBackground",value:function(t,e){return this.props.renderBackground(t,e)}},{key:"renderVertices",value:function(t){var e=this;return t.map(function(t){var n=t.vertex,i=t.index;return s.a.createElement(s.a.Fragment,{key:n.id},e.props.renderVertex({vertex:n,index:i}))})}},{key:"renderEdges",value:function(t,e){return this.state.isContainerElReady?s.a.createElement(G,{onAction:this.props.onAction,edges:Object(i.a)(t.values()),vertices:e.map(function(t){return t.vertex}),containerEl:this.containerRef.current,sourceEndpointStyles:this.props.sourceEndpointStyles,sourceEndpointOptions:this.props.sourceEndpointOptions,targetEndpointStyles:this.props.targetEndpointStyles,targetEndpointOptions:this.props.targetEndpointOptions,edgeStyles:this.props.edgeStyles,draggablePlumbOptions:this.props.draggablePlumbOptions}):null}},{key:"render",value:function(){var t=this.getVisibleVertices(),e=this.getVisibleEdges(),n=Object(i.a)(t.values()),o=this.getExtremeXAndY(),a=Object(r.a)(o,2),c=a[0],u=a[1];return s.a.createElement("div",{style:{height:"100%",overflow:"auto",position:"relative"},ref:this.containerRef,className:"diagramContainer",onScroll:this.handleScroll},this.renderVertices(n),this.renderEdges(e,n),this.renderSentinel(c,u),this.renderBackground(c,u))}}]),e}(s.a.PureComponent);Z.defaultProps={edges:[],renderBackground:function(){return null}};var $=Z,tt=200,et=200,nt=1500,it={initialVertices:[{left:300,top:100,width:tt,height:et,label:"Root",id:"r"},{left:300-tt,top:nt,width:tt,height:et,label:"L1",id:"l1"},{left:300+tt,top:nt,width:tt,height:et,label:"R1",id:"r1"},{left:500-tt,top:nt+1500,width:tt,height:et,label:"R1L2",id:"r1l2"},{left:500+tt,top:nt+1500,width:tt,height:et,label:"R1R2",id:"r1r2"},{left:500+tt-tt,top:nt+1500+1500,width:tt,height:et,label:"R1R2L3",id:"r1r2l3"},{left:500+tt+tt,top:nt+1500+1500,width:tt,height:et,label:"R1R2R3",id:"r1r2r3"}].map(function(t){return Object(B.a)({},t,{top:t.top+1e3})}),initialEdges:[{id:"r-l1"},{id:"r-r1"},{id:"r1-r1l2"},{id:"r1-r1r2"},{id:"r1r2-r1r2l3"},{id:"r1r2-r1r2r3"}].map(function(t){return Object(B.a)({},t,{sourceId:t.id.split("-")[0],targetId:t.id.split("-")[1]})})};function rt(t){return{vertices:t.initialVertices,edges:t.initialEdges}}function ot(t,e){switch(e.type){case"ITEM_DRAGGED":var n=t.vertices.map(function(t){return t.id===e.payload.vertexEl.dataset.id?Object(B.a)({},t,{left:e.payload.finalPos[0],top:e.payload.finalPos[1]}):t});return Object(B.a)({},t,{vertices:n})}}function st(t){var e=t.vertex,n=t.index;return s.a.createElement("div",{id:e.id,className:"vertex",style:{height:e.height,width:e.width,position:"absolute",left:e.left,top:e.top},"data-id":e.id,"data-index":n},s.a.createElement("span",null,n))}n(33);var at=document.getElementById("root");c.a.render(s.a.createElement(function(){var t=Object(o.useReducer)(ot,it,rt),e=Object(r.a)(t,2),n=e[0],i=e[1],a=Object(o.useCallback)(function(t){var e=t.vertex,n=t.index;return s.a.createElement(st,{vertex:e,index:n})},[]),c=Object(o.useCallback)(function(t,e){return s.a.createElement("div",{className:"sq-bg",style:{height:"".concat(e,"px"),width:"".concat(t,"px")}})},[]);return s.a.createElement($,{onAction:i,vertices:n.vertices,edges:n.edges,renderVertex:a,renderBackground:c})},null),at)}},[[19,1,2]]]);
//# sourceMappingURL=main.ab6ada3f.chunk.js.map