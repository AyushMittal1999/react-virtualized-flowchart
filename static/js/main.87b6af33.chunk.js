(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(t,e,n){t.exports=n(34)},32:function(t,e,n){},34:function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(2),o=n(0),s=n.n(o),a=n(16),c=n.n(a),h=n(4),u=n(5),l=n(7),f=n(6),d=n(8),v=n(9),p=n(17),g=n.n(p);var m={ge:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=n+1;e<=n;){var s=e+n>>>1;r(t[s],i)>=0?(o=s,n=s-1):e=s+1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=n+1;e<=n;){var o=e+n>>>1;t[o]>=i?(r=o,n=o-1):e=o+1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},gt:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=n+1;e<=n;){var s=e+n>>>1;r(t[s],i)>0?(o=s,n=s-1):e=s+1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=n+1;e<=n;){var o=e+n>>>1;t[o]>i?(r=o,n=o-1):e=o+1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},lt:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=e-1;e<=n;){var s=e+n>>>1;r(t[s],i)<0?(o=s,e=s+1):n=s-1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=e-1;e<=n;){var o=e+n>>>1;t[o]<i?(r=o,e=o+1):n=o-1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},le:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(var o=e-1;e<=n;){var s=e+n>>>1;r(t[s],i)<=0?(o=s,e=s+1):n=s-1}return o}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(var r=e-1;e<=n;){var o=e+n>>>1;t[o]<=i?(r=o,e=o+1):n=o-1}return r}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)},eq:function(t,e,n,i,r){return"function"===typeof n?function(t,e,n,i,r){for(;e<=n;){var o=e+n>>>1,s=r(t[o],i);if(0===s)return o;s<=0?e=o+1:n=o-1}return-1}(t,void 0===i?0:0|i,void 0===r?t.length-1:0|r,e,n):function(t,e,n,i){for(;e<=n;){var r=e+n>>>1,o=t[r];if(o===i)return r;o<=i?e=r+1:n=r-1}return-1}(t,void 0===n?0:0|n,void 0===i?t.length-1:0|i,e)}},y=0,b=1;function I(t,e,n,i,r){this.mid=t,this.left=e,this.right=n,this.leftPoints=i,this.rightPoints=r,this.count=(e?e.count:0)+(n?n.count:0)+i.length}var P=I.prototype;function E(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function w(t,e){var n=C(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function T(t,e){var n=t.intervals([]);n.push(e),w(t,n)}function x(t,e){var n=t.intervals([]),i=n.indexOf(e);return i<0?y:(n.splice(i,1),w(t,n),b)}function M(t,e,n){for(var i=0;i<t.length&&t[i][0]<=e;++i){var r=n(t[i]);if(r)return r}}function k(t,e,n){for(var i=t.length-1;i>=0&&t[i][1]>=e;--i){var r=n(t[i]);if(r)return r}}function j(t,e){for(var n=0;n<t.length;++n){var i=e(t[n]);if(i)return i}}function O(t,e){return t-e}function V(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function R(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function C(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(O);var i=e[e.length>>1],r=[],o=[],s=[];for(n=0;n<t.length;++n){var a=t[n];a[1]<i?r.push(a):i<a[0]?o.push(a):s.push(a)}var c=s,h=s.slice();return c.sort(V),h.sort(R),new I(i,C(r),C(o),c,h)}function A(t){this.root=t}P.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},P.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?T(this,t):this.left.insert(t):this.left=C([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?T(this,t):this.right.insert(t):this.right=C([t]);else{var n=m.ge(this.leftPoints,t,V),i=m.ge(this.rightPoints,t,R);this.leftPoints.splice(n,0,t),this.rightPoints.splice(i,0,t)}},P.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?x(this,t):2===(o=this.left.remove(t))?(this.left=null,this.count-=1,b):(o===b&&(this.count-=1),o):y;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?x(this,t):2===(o=this.right.remove(t))?(this.right=null,this.count-=1,b):(o===b&&(this.count-=1),o):y;if(1===this.count)return this.leftPoints[0]===t?2:y;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,i=this.left;i.right;)n=i,i=i.right;if(n===this)i.right=this.right;else{var r=this.left,o=this.right;n.count-=i.count,n.right=i.left,i.left=r,i.right=o}E(this,i),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?E(this,this.left):E(this,this.right);return b}for(r=m.ge(this.leftPoints,t,V);r<this.leftPoints.length&&this.leftPoints[r][0]===t[0];++r)if(this.leftPoints[r]===t){this.count-=1,this.leftPoints.splice(r,1);for(o=m.ge(this.rightPoints,t,R);o<this.rightPoints.length&&this.rightPoints[o][1]===t[1];++o)if(this.rightPoints[o]===t)return this.rightPoints.splice(o,1),b}return y},P.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return M(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return k(this.rightPoints,t,e)}return j(this.leftPoints,e)},P.queryInterval=function(t,e,n){var i;if(t<this.mid&&this.left&&(i=this.left.queryInterval(t,e,n)))return i;if(e>this.mid&&this.right&&(i=this.right.queryInterval(t,e,n)))return i;return e<this.mid?M(this.leftPoints,e,n):t>this.mid?k(this.rightPoints,t,n):j(this.leftPoints,n)};var S=A.prototype;function q(t){return t&&0!==t.length?new A(C(t)):new A(null)}S.insert=function(t){this.root?this.root.insert(t):this.root=new I(t[0],null,null,[t],[t])},S.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),e!==y}return!1},S.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},S.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(S,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(S,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var D=n(11);function N(t,e){var n=new Map(t.map(function(t){return[t.id,t]})),i=new Map(e.map(function(t){return[t.id,t]})),r=[],o=[];return n.forEach(function(t,e){i.has(e)&&n.get(e)===i.get(e)||o.push(t)}),i.forEach(function(t,e){n.has(e)&&n.get(e)===i.get(e)||r.push(t)}),{itemsAdded:r,itemsRemoved:o}}var L=function(t){function e(){var t,n;Object(h.a)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(t=Object(f.a)(e)).call.apply(t,[this].concat(r)))).removeConnectionsAndEndpoints=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(t){return n.plumbConnections[t.id]}).forEach(function(t){var e=t.endpoints;n.plumbInstance.deleteConnection(t),n.plumbInstance.deleteEndpoint(e[0]),n.plumbInstance.deleteEndpoint(e[1])})},n.addConnectionsAndEndpoints=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){var e=n.plumbInstance.addEndpoint(t.sourceId,{isSource:!0,anchor:"Bottom",paintStyle:{radius:1},connectorPaintStyle:{stroke:"blue",strokeWidth:0}}),i=n.plumbInstance.addEndpoint(t.targetId,{isTarget:!0,anchor:"Top",paintStyle:{fill:"blue",radius:1},connectorPaintStyle:{stroke:"blue",strokeWidth:0}});n.plumbConnections[t.id]=n.plumbInstance.connect({source:e,target:i,paintStyle:{stroke:"black"},connector:["Flowchart",{curviness:0,cornerRadius:20}],overlays:[["Label",{label:t.name}]]})})},n}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this;D.jsPlumb.ready(function(){t.plumbInstance=D.jsPlumb.getInstance(t.props.containerEl),t.plumbConnections={},t.drawConnections(),t.makeVerticesDraggable(t.props.vertices)})}},{key:"componentDidUpdate",value:function(t){t.edges!==this.props.edges&&this.updateConnections(N(t.edges,this.props.edges)),t.vertices!==this.props.vertices&&this.updateVertices(N(t.vertices,this.props.vertices))}},{key:"makeVerticesDraggable",value:function(t){var e=this;t.map(function(t,n){e.plumbInstance.draggable(t.id,{stop:function(t){e.props.onAction({type:"ITEM_DRAGGED",payload:{vertexId:t.el.id,finalPos:t.finalPos,index:n}})}})})}},{key:"updateConnections",value:function(t){var e=t.itemsAdded,n=t.itemsRemoved;this.removeConnectionsAndEndpoints(n),this.addConnectionsAndEndpoints(e)}},{key:"updateVertices",value:function(t){var e=t.itemsAdded;t.itemsRemoved;this.makeVerticesDraggable(e)}},{key:"drawConnections",value:function(){this.addConnectionsAndEndpoints(this.props.edges)}},{key:"render",value:function(){return null}}]),e}(o.PureComponent);L.displayName="Edges",L.defaultProps={};var X=L,Y=Object(v.a)(function(t){return t.reduce(function(t,e){return t.rightMostVertex.left<e.left&&(t.rightMostVertex=e),t.bottomMostVertex.top<e.top&&(t.bottomMostVertex=e),t},{rightMostVertex:{left:-1},bottomMostVertex:{top:-1}})}),G=Object(v.a)(function(t,e,n,i){var o=new Map(t.map(function(t){return[t.id,t]})),s=new Map,a=new Map,c=new Map;return n.queryInterval(e.xMin,e.xMax,function(t){var e=Object(r.a)(t,3),n=(e[0],e[1],e[2]);s.set(n,o.get(n))}),i.queryInterval(e.yMin,e.yMax,function(t){var e=Object(r.a)(t,3),n=(e[0],e[1],e[2]);a.set(n,o.get(n))}),s.forEach(function(t,e){a.has(e)&&c.set(e,t)}),c});function B(t,e,n){var i=t.get(n);i?i.push(e):t.set(n,[e])}var J=Object(v.a)(function(t,e,n,i){return{xMin:t,xMax:t+n,yMin:e,yMax:e+i}});function F(t,e,n){t.remove(e[n]),delete e[n]}var U=function(t){function e(t){var n;return Object(h.a)(this,e),(n=Object(l.a)(this,Object(f.a)(e).call(this,t))).addToXIntervalTree=function(t){var e=[t.left,t.left+t.width,t.id];n.xIntervalTreeNodes[t.id]=e,n.xIntervalTree.insert(e)},n.addToYIntervalTree=function(t){var e=[t.top,t.top+t.height,t.id];n.yIntervalTreeNodes[t.id]=e,n.yIntervalTree.insert(e)},n.updateScroll=g()(function(t){n.setState({scroll:{left:t.scrollLeft,top:t.scrollTop}})},0),n.handleScroll=function(t){n.updateScroll(t.target)},n.state={scroll:{left:0,top:0},container:{height:0,width:0},version:0,isContainerElReady:!1},n.containerRef=s.a.createRef(),n.initIntervalTrees(),n.initVerticesToEdgesMap(t.vertices,t.edges),n}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this.containerRef.current.getBoundingClientRect(),e=t.height,n=t.width;this.setState({container:{height:e,width:n},isContainerElReady:!0})}},{key:"componentDidUpdate",value:function(t,e,n){t.vertices!==this.props.vertices&&(this.updateIntervalTrees(N(t.vertices,this.props.vertices)),this.setState(function(t){return{version:t.version+1}}))}},{key:"initIntervalTrees",value:function(){this.initXIntervalTree(this.props.vertices),this.initYIntervalTree(this.props.vertices)}},{key:"initXIntervalTree",value:function(t){this.xIntervalTree=q(),this.xIntervalTreeNodes={},t.forEach(this.addToXIntervalTree)}},{key:"initYIntervalTree",value:function(t){this.yIntervalTree=q(),this.yIntervalTreeNodes={},t.forEach(this.addToYIntervalTree)}},{key:"initVerticesToEdgesMap",value:function(t,e){this.verticesToEdgesMap=e.reduce(function(t,e){return B(t,e,e.sourceId),B(t,e,e.targetId),t},new Map)}},{key:"updateIntervalTrees",value:function(t){var e=this,n=t.itemsAdded;t.itemsRemoved.forEach(function(t){var n=t.id;F(e.xIntervalTree,e.xIntervalTreeNodes,n),F(e.yIntervalTree,e.yIntervalTreeNodes,n)}),n.forEach(function(t){e.addToXIntervalTree(t),e.addToYIntervalTree(t)})}},{key:"getVisibleVertices",value:function(){var t=this.state,e=t.scroll,n=t.container;return G(this.props.vertices,J(e.left,e.top,n.width,n.height),this.xIntervalTree,this.yIntervalTree)}},{key:"renderSentinel",value:function(){var t=Y(this.props.vertices),e=t.rightMostVertex,n=t.bottomMostVertex,i=e.left+e.width+100,r=n.top+n.width+100;return s.a.createElement("div",{style:{height:1,width:1,position:"absolute",left:0,top:0,transform:"translate3d(".concat(i,"px, ").concat(r,"px, 0)")}})}},{key:"renderVertices",value:function(t){var e=this;return t.map(function(t,n){return s.a.createElement(s.a.Fragment,{key:t.id},e.props.renderVertex({vertex:t,index:n}))})}},{key:"renderEdges",value:function(t,e){return this.state.isContainerElReady?s.a.createElement(X,{onAction:this.props.onAction,edges:Object(i.a)(t.values()),vertices:e,containerEl:this.containerRef.current}):null}},{key:"render",value:function(){var t=this.getVisibleVertices(),e=function(t,e,n){var r=new Map(n.map(function(t){return[t.id,t]}));return Object(i.a)(t.values()).reduce(function(n,i){return(e.get(i.id)||[]).forEach(function(e){n.edges.set(e.id,e),t.has(e.sourceId)||n.missedVertices.set(e.sourceId,r.get(e.sourceId)),t.has(e.targetId)||n.missedVertices.set(e.targetId,r.get(e.targetId))}),n},{edges:new Map,missedVertices:new Map})}(t,this.verticesToEdgesMap,this.props.vertices),n=e.edges,r=e.missedVertices,o=[].concat(Object(i.a)(t.values()),Object(i.a)(r.values()));return s.a.createElement("div",{ref:this.containerRef,className:"diagramContainer full-height",onScroll:this.handleScroll},this.renderVertices(o),this.renderEdges(n,o),this.renderSentinel())}}]),e}(s.a.PureComponent);U.defaultProps={edges:[]};var W=U,_=[0,2e3],z=[0,3e3],H=[100,300],K=[100,300];function Q(t,e){return Math.floor(Math.random()*(e-t))+t}Object(i.a)(Array(100)).map(function(t,e){return n=e,{left:Q(_[0],_[1]),top:Q(z[0],z[1]),width:Q(H[0],H[1]),height:Q(K[0],K[1]),label:n,id:n};var n});var Z=250,$=250,tt=25,et=(_[1]-_[0])/(Z+tt),nt=(z[1]-z[0])/($+tt);!function(){for(var t=[],e=0;e<nt;e++)for(var n=0;n<et;n++)t.push({left:n*(Z+tt),top:e*($+tt),width:Z,height:$,label:"".concat(n,"-").concat(e),id:"".concat(n,"-").concat(e)})}();var it=n(3),rt=200,ot=200,st={initialVertices:[{left:300,top:100,width:rt,height:ot,label:"Root",id:"r"},{left:300-rt,top:500,width:rt,height:ot,label:"L1",id:"l1"},{left:300+rt,top:500,width:rt,height:ot,label:"R1",id:"r1"},{left:500-rt,top:1e3,width:rt,height:ot,label:"R1L2",id:"r1l2"},{left:500+rt,top:1e3,width:rt,height:ot,label:"R1R2",id:"r1r2"},{left:500+rt-rt,top:1500,width:rt,height:ot,label:"R1R2L3",id:"r1r2l3"},{left:500+rt+rt,top:1500,width:rt,height:ot,label:"R1R2R3",id:"r1r2r3"}].map(function(t){return Object(it.a)({},t,{top:t.top+1e3})}),initialEdges:[{id:"r-l1"},{id:"r-r1"},{id:"r1-r1l2"},{id:"r1-r1r2"},{id:"r1r2-r1r2l3"},{id:"r1r2-r1r2r3"}].map(function(t){return Object(it.a)({},t,{sourceId:t.id.split("-")[0],targetId:t.id.split("-")[1]})})};function at(t){return{vertices:t.initialVertices,edges:t.initialEdges}}function ct(t,e){switch(e.type){case"ITEM_DRAGGED":var n=t.vertices.map(function(t){return t.id===e.payload.vertexId?Object(it.a)({},t,{left:e.payload.finalPos[0],top:e.payload.finalPos[1]}):t});return Object(it.a)({},t,{vertices:n})}}function ht(t){var e=t.vertex;return s.a.createElement("div",{id:e.id,className:"vertex",style:{height:e.height,width:e.width,position:"absolute",left:e.left,top:e.top}},s.a.createElement("span",null,JSON.stringify(e)))}n(32);var ut=document.getElementById("root");c.a.render(s.a.createElement(function(){var t=Object(o.useReducer)(ct,st,at),e=Object(r.a)(t,2),n=e[0],i=e[1],a=Object(o.useCallback)(function(t){var e=t.vertex;return s.a.createElement(ht,{vertex:e})},[]);return s.a.createElement(W,{onAction:i,vertices:n.vertices,edges:n.edges,renderVertex:a})},null),ut)}},[[18,2,1]]]);
//# sourceMappingURL=main.87b6af33.chunk.js.map